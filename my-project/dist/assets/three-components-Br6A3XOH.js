import{r as x,j as ct,P as Ot,a as Lt,u as _t}from"./react-three-CwVO3Jha.js";import{k as Et,l as rt,m as Gt,n as O,o as zt,d as Bt,p as $t,q as qt}from"./three-TqPnz05j.js";import{L as Qt,g as B,F as Xt,S as Yt,a as at}from"./utils-DVgDaGdu.js";class Zt{constructor(o=Math){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(let t=0;t<256;t++)this.p[t]=Math.floor(o.random()*256);this.perm=[];for(let t=0;t<512;t++)this.perm[t]=this.p[t&255];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}dot(o,t,s){return o[0]*t+o[1]*s}dot3(o,t,s,i){return o[0]*t+o[1]*s+o[2]*i}dot4(o,t,s,i,l){return o[0]*t+o[1]*s+o[2]*i+o[3]*l}noise(o,t){let s,i,l;const a=.5*(Math.sqrt(3)-1),n=(o+t)*a,u=Math.floor(o+n),e=Math.floor(t+n),r=(3-Math.sqrt(3))/6,h=(u+e)*r,M=u-h,d=e-h,m=o-M,f=t-d;let j,E;m>f?(j=1,E=0):(j=0,E=1);const p=m-j+r,g=f-E+r,w=m-1+2*r,P=f-1+2*r,z=u&255,C=e&255,T=this.perm[z+this.perm[C]]%12,b=this.perm[z+j+this.perm[C+E]]%12,y=this.perm[z+1+this.perm[C+1]]%12;let S=.5-m*m-f*f;S<0?s=0:(S*=S,s=S*S*this.dot(this.grad3[T],m,f));let v=.5-p*p-g*g;v<0?i=0:(v*=v,i=v*v*this.dot(this.grad3[b],p,g));let F=.5-w*w-P*P;return F<0?l=0:(F*=F,l=F*F*this.dot(this.grad3[y],w,P)),70*(s+i+l)}noise3d(o,t,s){let i,l,a,n;const e=(o+t+s)*.3333333333333333,r=Math.floor(o+e),h=Math.floor(t+e),M=Math.floor(s+e),d=1/6,m=(r+h+M)*d,f=r-m,j=h-m,E=M-m,p=o-f,g=t-j,w=s-E;let P,z,C,T,b,y;p>=g?g>=w?(P=1,z=0,C=0,T=1,b=1,y=0):p>=w?(P=1,z=0,C=0,T=1,b=0,y=1):(P=0,z=0,C=1,T=1,b=0,y=1):g<w?(P=0,z=0,C=1,T=0,b=1,y=1):p<w?(P=0,z=1,C=0,T=0,b=1,y=1):(P=0,z=1,C=0,T=1,b=1,y=0);const S=p-P+d,v=g-z+d,F=w-C+d,$=p-T+2*d,q=g-b+2*d,Q=w-y+2*d,X=p-1+3*d,Y=g-1+3*d,k=w-1+3*d,L=r&255,_=h&255,G=M&255,et=this.perm[L+this.perm[_+this.perm[G]]]%12,st=this.perm[L+P+this.perm[_+z+this.perm[G+C]]]%12,ot=this.perm[L+T+this.perm[_+b+this.perm[G+y]]]%12,nt=this.perm[L+1+this.perm[_+1+this.perm[G+1]]]%12;let D=.6-p*p-g*g-w*w;D<0?i=0:(D*=D,i=D*D*this.dot3(this.grad3[et],p,g,w));let A=.6-S*S-v*v-F*F;A<0?l=0:(A*=A,l=A*A*this.dot3(this.grad3[st],S,v,F));let I=.6-$*$-q*q-Q*Q;I<0?a=0:(I*=I,a=I*I*this.dot3(this.grad3[ot],$,q,Q));let R=.6-X*X-Y*Y-k*k;return R<0?n=0:(R*=R,n=R*R*this.dot3(this.grad3[nt],X,Y,k)),32*(i+l+a+n)}noise4d(o,t,s,i){const l=this.grad4,a=this.simplex,n=this.perm,u=(Math.sqrt(5)-1)/4,e=(5-Math.sqrt(5))/20;let r,h,M,d,m;const f=(o+t+s+i)*u,j=Math.floor(o+f),E=Math.floor(t+f),p=Math.floor(s+f),g=Math.floor(i+f),w=(j+E+p+g)*e,P=j-w,z=E-w,C=p-w,T=g-w,b=o-P,y=t-z,S=s-C,v=i-T,F=b>y?32:0,$=b>S?16:0,q=y>S?8:0,Q=b>v?4:0,X=y>v?2:0,Y=S>v?1:0,k=F+$+q+Q+X+Y,L=a[k][0]>=3?1:0,_=a[k][1]>=3?1:0,G=a[k][2]>=3?1:0,et=a[k][3]>=3?1:0,st=a[k][0]>=2?1:0,ot=a[k][1]>=2?1:0,nt=a[k][2]>=2?1:0,D=a[k][3]>=2?1:0,A=a[k][0]>=1?1:0,I=a[k][1]>=1?1:0,R=a[k][2]>=1?1:0,kt=a[k][3]>=1?1:0,it=b-L+e,lt=y-_+e,ut=S-G+e,ht=v-et+e,mt=b-st+2*e,dt=y-ot+2*e,ft=S-nt+2*e,pt=v-D+2*e,gt=b-A+3*e,Mt=y-I+3*e,wt=S-R+3*e,bt=v-kt+3*e,yt=b-1+4*e,St=y-1+4*e,vt=S-1+4*e,xt=v-1+4*e,Z=j&255,N=E&255,U=p&255,W=g&255,Ft=n[Z+n[N+n[U+n[W]]]]%32,Dt=n[Z+L+n[N+_+n[U+G+n[W+et]]]]%32,At=n[Z+st+n[N+ot+n[U+nt+n[W+D]]]]%32,It=n[Z+A+n[N+I+n[U+R+n[W+kt]]]]%32,Rt=n[Z+1+n[N+1+n[U+1+n[W+1]]]]%32;let H=.6-b*b-y*y-S*S-v*v;H<0?r=0:(H*=H,r=H*H*this.dot4(l[Ft],b,y,S,v));let V=.6-it*it-lt*lt-ut*ut-ht*ht;V<0?h=0:(V*=V,h=V*V*this.dot4(l[Dt],it,lt,ut,ht));let K=.6-mt*mt-dt*dt-ft*ft-pt*pt;K<0?M=0:(K*=K,M=K*K*this.dot4(l[At],mt,dt,ft,pt));let J=.6-gt*gt-Mt*Mt-wt*wt-bt*bt;J<0?d=0:(J*=J,d=J*J*this.dot4(l[It],gt,Mt,wt,bt));let tt=.6-yt*yt-St*St-vt*vt-xt*xt;return tt<0?m=0:(tt*=tt,m=tt*tt*this.dot4(l[Rt],yt,St,vt,xt)),27*(r+h+M+d+m)}}const jt=new Zt,Pt=new Qt(50),Nt=()=>{const c=document.createElement("canvas");c.width=128,c.height=128;const o=c.getContext("2d"),t=o.createImageData(128,128);for(let u=0;u<t.data.length;u+=4){const e=Math.random(),r=Math.floor(220+e*10);t.data[u]=r-1,t.data[u+1]=r,t.data[u+2]=r+1,t.data[u+3]=255}o.putImageData(t,0,0);const s=new Et(c);s.wrapS=rt,s.wrapT=rt,s.repeat.set(1.2,1.2);const i=document.createElement("canvas");i.width=64,i.height=64;const l=i.getContext("2d"),a=l.createImageData(64,64);for(let u=0;u<a.data.length;u+=4)a.data[u]=Math.floor(128+(Math.random()-.5)*8),a.data[u+1]=Math.floor(128+(Math.random()-.5)*8),a.data[u+2]=Math.floor(220+Math.random()*20),a.data[u+3]=255;l.putImageData(a,0,0);const n=new Et(i);return n.wrapS=rt,n.wrapT=rt,{colorTexture:s,normalTexture:n}},Ct=Nt();function Ut({distance:c=10,quality:o="medium",enableTextures:t=!0,isStatic:s=!1}={}){const i=x.useRef(null),l=x.useMemo(()=>({low:c>30?[.8,12,8]:[.8,16,12],medium:c>30?[.8,20,14]:[.8,32,24],high:c>30?[.8,32,24]:[.8,48,32]})[o],[c,o]),a=x.useMemo(()=>{const u=`${l.join("-")}-${c}-${s}`;if(Pt.has(u))return Pt.get(u).clone();const e=new Gt(...l);if(!s){const r=e.attributes.position,h=c>25?.008:.015,M=c>25?.3:.4,d=c>25?.8:1.2,m=.92;for(let f=0;f<r.count;f++){const j=r.getX(f),E=r.getY(f),p=r.getZ(f);let g;if(c>25)g=jt.noise3d(j*M,E*M,p*M);else{const w=jt.noise3d(j*M,E*M,p*M)*.8,P=jt.noise3d(j*d,E*d,p*d)*.2;g=w+P}r.setXYZ(f,j+g*h*Math.abs(j),E*m+g*h*.1,p+g*h*Math.abs(p))}r.needsUpdate=!0,e.computeVertexNormals()}return Pt.set(u,e),e.clone()},[l,c,s]),n=x.useMemo(()=>{const u={color:new O(.98,.98,.98),roughness:.8,metalness:.02,envMapIntensity:.12};return t&&c<25?new zt({...u,map:Ct.colorTexture,normalMap:Ct.normalTexture,normalScale:new Bt(.3,.3)}):new zt(u)},[c,t]);return x.useEffect(()=>{i.current&&a&&(i.current.geometry=a)},[a]),ct.jsx("mesh",{ref:i,material:n,castShadow:!0,receiveShadow:!0,children:ct.jsx("sphereGeometry",{args:l})})}const ee=Object.freeze(Object.defineProperty({__proto__:null,ProceduralPebble:Ut},Symbol.toStringTag,{value:"Module"}));function Wt(){const[c,o]=x.useState(!1);return x.useEffect(()=>{if(typeof window<"u"&&window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion: reduce)");o(t.matches);const s=i=>{o(i.matches)};return t.addEventListener("change",s),()=>{t.removeEventListener("change",s)}}},[]),{prefersReducedMotion:c,getAnimationConfig:(t,s=0)=>c?s:t,shouldAnimate:!c}}const Tt=[new O("#E8D5E5"),new O("#C5D1E8"),new O("#D1E2F0"),new O("#F0EDE0"),new O("#F0E5E0"),new O("#C7E6F7"),new O("#e1eaf7")],Ht=({count:c=3500})=>{const o=x.useRef(null),{prefersReducedMotion:t,getAnimationConfig:s}=Wt(),i=x.useRef(0),l=x.useMemo(()=>{const a=new Float32Array(c*3),n=new Float32Array(c*3),u=new Float32Array(c),e=new Float32Array(c);for(let r=0;r<c;r++){const h=200+Math.random()*400,M=Math.random()*Math.PI*2,d=Math.acos(Math.random()*2-1);a[r*3]=h*Math.sin(d)*Math.cos(M),a[r*3+1]=h*Math.sin(d)*Math.sin(M)*.7,a[r*3+2]=h*Math.cos(d)*.6;const m=Tt[Math.floor(Math.random()*Tt.length)];n[r*3]=m.r,n[r*3+1]=m.g,n[r*3+2]=m.b,u[r]=Math.random()*.4+.2,e[r]=Math.random()*Math.PI*2}return{positions:a,colors:n,baseScales:u,phaseOffsets:e}},[c]);return x.useEffect(()=>{const a=`bokeh-bubbles-${Math.random().toString(36).substr(2,9)}`;return B.addTask({id:a,priority:3,updateInterval:t?100:16,callback:n=>{if(!o.current)return;const u=s(1,.1);i.current+=n*u;const e=i.current%19;let r=1;e<4?r=1+s(.1,.02)*(e/4):e<11?r=1+s(.1,.02):r=1+s(.1,.02)-s(.15,.03)*((e-11)/8);const h=o.current.geometry;if(!h.attributes.size){const m=new Float32Array(c);for(let f=0;f<c;f++)m[f]=l.baseScales[f];h.setAttribute("size",new $t(m,1))}const M=h.attributes.size.array;for(let m=0;m<c;m++){const f=Math.sin(i.current*.6+l.phaseOffsets[m]);M[m]=l.baseScales[m]*r*(.8+.3*f)}h.attributes.size.needsUpdate=!0;const d=i.current;o.current.rotation.x=Math.sin(d*.05)*s(.05,.01),o.current.rotation.y=Math.sin(d*.08)*s(.08,.02),o.current.rotation.z=Math.sin(d*.03)*s(.02,.005)}}),()=>{B.removeTask(a)}},[c,l,t,s]),ct.jsxs(Ot,{ref:o,positions:l.positions,colors:l.colors,children:["      ",ct.jsx(Lt,{transparent:!0,size:1.1,sizeAttenuation:!0,depthWrite:!1,vertexColors:!0,blending:qt,opacity:.4})]},c)},se=Object.freeze(Object.defineProperty({__proto__:null,default:Ht},Symbol.toStringTag,{value:"Module"}));function Vt(){const{scene:c,camera:o}=_t(),t=x.useRef(),s=x.useRef();return x.useEffect(()=>(t.current=new Xt,s.current=new Yt(50),console.log("ðŸŽ¯ Scene Manager: Spatial systems initialized"),()=>{t.current=void 0,s.current=void 0}),[o]),x.useEffect(()=>{const i="scene-manager-optimization";return B.addTask({id:i,priority:8,updateInterval:100,callback:()=>{if(!t.current||!s.current)return;at.update();const l=at.getPerformanceLevel(),a=l==="low",n=l==="high";t.current.updateCamera(o);const u=t.current.cullObjects();s.current.clear(),u.visible.forEach(e=>{e.object.position&&s.current.insert(e.id,e.object.position)}),c.traverse(e=>{if(e.userData.isOptimizable){const r=o.position.distanceTo(e.position);let h;a?h=r>20?"low":"medium":n?h=r>30?"medium":"high":h=r>25?"low":r>15?"medium":"high",e.userData.updateQuality&&e.userData.currentQuality!==h&&(e.userData.updateQuality(h),e.userData.currentQuality=h)}})}}),()=>{B.removeTask(i)}},[c,o]),x.useEffect(()=>{const i=setInterval(()=>{var n;const l=at.getPerformanceLevel(),a=B.getFrameStats();console.log("ðŸ”§ Performance Metrics:",{"Performance Level":l,"Animation Efficiency":Math.round(a.efficiency*100)+"%","Scheduler Tasks":B.getTaskCount(),"Spatial Objects":((n=s.current)==null?void 0:n.getStats().totalObjects)||0})},5e3);return()=>clearInterval(i)},[]),x.useEffect(()=>{window.sceneDebug={frustumCuller:t.current,spatialGrid:s.current,getPerformanceLevel:()=>at.getPerformanceLevel(),getSchedulerStats:()=>B.getFrameStats()}},[]),null}const oe=Object.freeze(Object.defineProperty({__proto__:null,SceneManager:Vt},Symbol.toStringTag,{value:"Module"}));export{se as B,Ut as P,oe as S,ee as a};
//# sourceMappingURL=three-components-Br6A3XOH.js.map
