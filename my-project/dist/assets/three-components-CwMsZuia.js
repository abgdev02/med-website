import{r as E,j as ct,P as Lt,a as _t,u as Gt}from"./react-three-CFZgPWMk.js";import{k as L,l as $t,m as Bt,n as qt,o as Et,d as Qt,p as zt,q as rt}from"./three-ohGAOD3z.js";import{g as F,L as Xt,F as Yt,S as Nt,a as at}from"./utils-CL1GXwyO.js";function At(){const[a,n]=E.useState(!1);return E.useEffect(()=>{if(typeof window<"u"&&window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion: reduce)");n(t.matches);const s=l=>{n(l.matches)};return t.addEventListener("change",s),()=>{t.removeEventListener("change",s)}}},[]),{prefersReducedMotion:a,getAnimationConfig:(t,s=0)=>a?s:t,shouldAnimate:!a}}const Ct=[new L("#E8D5E5"),new L("#C5D1E8"),new L("#D1E2F0"),new L("#F0EDE0"),new L("#F0E5E0"),new L("#C7E6F7"),new L("#e1eaf7")],Zt=({count:a=3500})=>{const n=E.useRef(null),{prefersReducedMotion:t,getAnimationConfig:s}=At(),l=E.useRef(0),i=E.useMemo(()=>{const c=new Float32Array(a*3),o=new Float32Array(a*3),d=new Float32Array(a),e=new Float32Array(a);for(let r=0;r<a;r++){const m=200+Math.random()*400,g=Math.random()*Math.PI*2,h=Math.acos(Math.random()*2-1);c[r*3]=m*Math.sin(h)*Math.cos(g),c[r*3+1]=m*Math.sin(h)*Math.sin(g)*.7,c[r*3+2]=m*Math.cos(h)*.6;const u=Ct[Math.floor(Math.random()*Ct.length)];o[r*3]=u.r,o[r*3+1]=u.g,o[r*3+2]=u.b,d[r]=Math.random()*.4+.2,e[r]=Math.random()*Math.PI*2}return{positions:c,colors:o,baseScales:d,phaseOffsets:e}},[a]);return E.useEffect(()=>{const c=`bokeh-bubbles-${Math.random().toString(36).substr(2,9)}`;return F.addTask({id:c,priority:3,updateInterval:t?100:16,callback:o=>{if(!n.current)return;const d=s(1,.1);l.current+=o*d;const e=l.current%19;let r=1;e<4?r=1+s(.1,.02)*(e/4):e<11?r=1+s(.1,.02):r=1+s(.1,.02)-s(.15,.03)*((e-11)/8);const m=n.current.geometry;if(!m.attributes.size){const u=new Float32Array(a);for(let f=0;f<a;f++)u[f]=i.baseScales[f];m.setAttribute("size",new $t(u,1))}const g=m.attributes.size.array;for(let u=0;u<a;u++){const f=Math.sin(l.current*.6+i.phaseOffsets[u]);g[u]=i.baseScales[u]*r*(.8+.3*f)}m.attributes.size.needsUpdate=!0;const h=l.current;n.current.rotation.x=Math.sin(h*.05)*s(.05,.01),n.current.rotation.y=Math.sin(h*.08)*s(.08,.02),n.current.rotation.z=Math.sin(h*.03)*s(.02,.005)}}),()=>{F.removeTask(c)}},[a,i,t,s]),ct.jsxs(Lt,{ref:n,positions:i.positions,colors:i.colors,children:["      ",ct.jsx(_t,{transparent:!0,size:1.1,sizeAttenuation:!0,depthWrite:!1,vertexColors:!0,blending:Bt,opacity:.4})]},a)},ee=Object.freeze(Object.defineProperty({__proto__:null,default:Zt},Symbol.toStringTag,{value:"Module"}));class Ut{constructor(n=Math){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(let t=0;t<256;t++)this.p[t]=Math.floor(n.random()*256);this.perm=[];for(let t=0;t<512;t++)this.perm[t]=this.p[t&255];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}dot(n,t,s){return n[0]*t+n[1]*s}dot3(n,t,s,l){return n[0]*t+n[1]*s+n[2]*l}dot4(n,t,s,l,i){return n[0]*t+n[1]*s+n[2]*l+n[3]*i}noise(n,t){let s,l,i;const c=.5*(Math.sqrt(3)-1),o=(n+t)*c,d=Math.floor(n+o),e=Math.floor(t+o),r=(3-Math.sqrt(3))/6,m=(d+e)*r,g=d-m,h=e-m,u=n-g,f=t-h;let y,z;u>f?(y=1,z=0):(y=0,z=1);const j=u-y+r,M=f-z+r,p=u-1+2*r,P=f-1+2*r,S=d&255,v=e&255,T=this.perm[S+this.perm[v]]%12,b=this.perm[S+y+this.perm[v+z]]%12,w=this.perm[S+1+this.perm[v+1]]%12;let x=.5-u*u-f*f;x<0?s=0:(x*=x,s=x*x*this.dot(this.grad3[T],u,f));let k=.5-j*j-M*M;k<0?l=0:(k*=k,l=k*k*this.dot(this.grad3[b],j,M));let A=.5-p*p-P*P;return A<0?i=0:(A*=A,i=A*A*this.dot(this.grad3[w],p,P)),70*(s+l+i)}noise3d(n,t,s){let l,i,c,o;const e=(n+t+s)*.3333333333333333,r=Math.floor(n+e),m=Math.floor(t+e),g=Math.floor(s+e),h=1/6,u=(r+m+g)*h,f=r-u,y=m-u,z=g-u,j=n-f,M=t-y,p=s-z;let P,S,v,T,b,w;j>=M?M>=p?(P=1,S=0,v=0,T=1,b=1,w=0):j>=p?(P=1,S=0,v=0,T=1,b=0,w=1):(P=0,S=0,v=1,T=1,b=0,w=1):M<p?(P=0,S=0,v=1,T=0,b=1,w=1):j<p?(P=0,S=1,v=0,T=0,b=1,w=1):(P=0,S=1,v=0,T=1,b=1,w=0);const x=j-P+h,k=M-S+h,A=p-v+h,B=j-T+2*h,q=M-b+2*h,Q=p-w+2*h,X=j-1+3*h,Y=M-1+3*h,C=p-1+3*h,_=r&255,G=m&255,$=g&255,et=this.perm[_+this.perm[G+this.perm[$]]]%12,st=this.perm[_+P+this.perm[G+S+this.perm[$+v]]]%12,ot=this.perm[_+T+this.perm[G+b+this.perm[$+w]]]%12,nt=this.perm[_+1+this.perm[G+1+this.perm[$+1]]]%12;let D=.6-j*j-M*M-p*p;D<0?l=0:(D*=D,l=D*D*this.dot3(this.grad3[et],j,M,p));let I=.6-x*x-k*k-A*A;I<0?i=0:(I*=I,i=I*I*this.dot3(this.grad3[st],x,k,A));let R=.6-B*B-q*q-Q*Q;R<0?c=0:(R*=R,c=R*R*this.dot3(this.grad3[ot],B,q,Q));let O=.6-X*X-Y*Y-C*C;return O<0?o=0:(O*=O,o=O*O*this.dot3(this.grad3[nt],X,Y,C)),32*(l+i+c+o)}noise4d(n,t,s,l){const i=this.grad4,c=this.simplex,o=this.perm,d=(Math.sqrt(5)-1)/4,e=(5-Math.sqrt(5))/20;let r,m,g,h,u;const f=(n+t+s+l)*d,y=Math.floor(n+f),z=Math.floor(t+f),j=Math.floor(s+f),M=Math.floor(l+f),p=(y+z+j+M)*e,P=y-p,S=z-p,v=j-p,T=M-p,b=n-P,w=t-S,x=s-v,k=l-T,A=b>w?32:0,B=b>x?16:0,q=w>x?8:0,Q=b>k?4:0,X=w>k?2:0,Y=x>k?1:0,C=A+B+q+Q+X+Y,_=c[C][0]>=3?1:0,G=c[C][1]>=3?1:0,$=c[C][2]>=3?1:0,et=c[C][3]>=3?1:0,st=c[C][0]>=2?1:0,ot=c[C][1]>=2?1:0,nt=c[C][2]>=2?1:0,D=c[C][3]>=2?1:0,I=c[C][0]>=1?1:0,R=c[C][1]>=1?1:0,O=c[C][2]>=1?1:0,Pt=c[C][3]>=1?1:0,it=b-_+e,lt=w-G+e,ut=x-$+e,ht=k-et+e,dt=b-st+2*e,mt=w-ot+2*e,ft=x-nt+2*e,pt=k-D+2*e,gt=b-I+3*e,Mt=w-R+3*e,bt=x-O+3*e,wt=k-Pt+3*e,yt=b-1+4*e,St=w-1+4*e,vt=x-1+4*e,xt=k-1+4*e,N=y&255,Z=z&255,U=j&255,W=M&255,Ft=o[N+o[Z+o[U+o[W]]]]%32,Dt=o[N+_+o[Z+G+o[U+$+o[W+et]]]]%32,It=o[N+st+o[Z+ot+o[U+nt+o[W+D]]]]%32,Rt=o[N+I+o[Z+R+o[U+O+o[W+Pt]]]]%32,Ot=o[N+1+o[Z+1+o[U+1+o[W+1]]]]%32;let H=.6-b*b-w*w-x*x-k*k;H<0?r=0:(H*=H,r=H*H*this.dot4(i[Ft],b,w,x,k));let V=.6-it*it-lt*lt-ut*ut-ht*ht;V<0?m=0:(V*=V,m=V*V*this.dot4(i[Dt],it,lt,ut,ht));let K=.6-dt*dt-mt*mt-ft*ft-pt*pt;K<0?g=0:(K*=K,g=K*K*this.dot4(i[It],dt,mt,ft,pt));let J=.6-gt*gt-Mt*Mt-bt*bt-wt*wt;J<0?h=0:(J*=J,h=J*J*this.dot4(i[Rt],gt,Mt,bt,wt));let tt=.6-yt*yt-St*St-vt*vt-xt*xt;return tt<0?u=0:(tt*=tt,u=tt*tt*this.dot4(i[Ot],yt,St,vt,xt)),27*(r+m+g+h+u)}}const kt=new Ut,jt=new Xt(50),Wt=()=>{const a=document.createElement("canvas");a.width=128,a.height=128;const n=a.getContext("2d"),t=n.createImageData(128,128);for(let d=0;d<t.data.length;d+=4){const e=Math.random(),r=Math.floor(220+e*10);t.data[d]=r-1,t.data[d+1]=r,t.data[d+2]=r+1,t.data[d+3]=255}n.putImageData(t,0,0);const s=new zt(a);s.wrapS=rt,s.wrapT=rt,s.repeat.set(1.2,1.2);const l=document.createElement("canvas");l.width=64,l.height=64;const i=l.getContext("2d"),c=i.createImageData(64,64);for(let d=0;d<c.data.length;d+=4)c.data[d]=Math.floor(128+(Math.random()-.5)*8),c.data[d+1]=Math.floor(128+(Math.random()-.5)*8),c.data[d+2]=Math.floor(220+Math.random()*20),c.data[d+3]=255;i.putImageData(c,0,0);const o=new zt(l);return o.wrapS=rt,o.wrapT=rt,{colorTexture:s,normalTexture:o}},Tt=Wt();function Ht({distance:a=10,animate:n=!0,quality:t="medium",enableTextures:s=!0,isStatic:l=!1}={}){const i=E.useRef(null),{shouldAnimate:c,getAnimationConfig:o}=At(),d=n&&c,e=E.useMemo(()=>({low:a>30?[.8,12,8]:[.8,16,12],medium:a>30?[.8,20,14]:[.8,32,24],high:a>30?[.8,32,24]:[.8,48,32]})[t],[a,t]),r=E.useMemo(()=>{const g=`${e.join("-")}-${a}-${l}`;if(jt.has(g))return jt.get(g).clone();const h=new qt(...e);if(!l){const u=h.attributes.position,f=a>25?.008:.015,y=a>25?.3:.4,z=a>25?.8:1.2,j=.92;for(let M=0;M<u.count;M++){const p=u.getX(M),P=u.getY(M),S=u.getZ(M);let v;if(a>25)v=kt.noise3d(p*y,P*y,S*y);else{const T=kt.noise3d(p*y,P*y,S*y)*.8,b=kt.noise3d(p*z,P*z,S*z)*.2;v=T+b}u.setXYZ(M,p+v*f*Math.abs(p),P*j+v*f*.1,S+v*f*Math.abs(S))}u.needsUpdate=!0,h.computeVertexNormals()}return jt.set(g,h),h.clone()},[e,a,l]),m=E.useMemo(()=>{const g={color:new L(.98,.98,.98),roughness:.8,metalness:.02,envMapIntensity:.12};return s&&a<25?new Et({...g,map:Tt.colorTexture,normalMap:Tt.normalTexture,normalScale:new Qt(.3,.3)}):new Et(g)},[a,s]);return E.useEffect(()=>{i.current&&r&&(i.current.geometry=r)},[r]),E.useEffect(()=>{if(!d||!i.current)return;const g=a>25?1:5,h=a>25?.15:.25,u=o(h,.05),f=a>25?32:16,y=`pebble-${Math.random().toString(36).substr(2,9)}`;return F.addTask({id:y,priority:g,updateInterval:f,callback:z=>{i.current&&(i.current.rotation.y+=z*u)}}),()=>{F.removeTask(y)}},[d,a,o]),ct.jsx("mesh",{ref:i,material:m,castShadow:!0,receiveShadow:!0,children:ct.jsx("sphereGeometry",{args:e})})}const se=Object.freeze(Object.defineProperty({__proto__:null,ProceduralPebble:Ht},Symbol.toStringTag,{value:"Module"}));function Vt(){const{scene:a,camera:n}=Gt(),t=E.useRef(),s=E.useRef();return E.useEffect(()=>(t.current=new Yt,s.current=new Nt(50),console.log("ðŸŽ¯ Scene Manager: Spatial systems initialized"),()=>{t.current=void 0,s.current=void 0}),[n]),E.useEffect(()=>{const l="scene-manager-optimization";return F.addTask({id:l,priority:8,updateInterval:100,callback:()=>{if(!t.current||!s.current)return;at.update();const i=at.getPerformanceLevel(),c=i==="low",o=i==="high";t.current.updateCamera(n);const d=t.current.cullObjects();s.current.clear(),d.visible.forEach(e=>{e.object.position&&s.current.insert(e.id,e.object.position)}),a.traverse(e=>{if(e.userData.isOptimizable){const r=n.position.distanceTo(e.position);let m;c?m=r>20?"low":"medium":o?m=r>30?"medium":"high":m=r>25?"low":r>15?"medium":"high",e.userData.updateQuality&&e.userData.currentQuality!==m&&(e.userData.updateQuality(m),e.userData.currentQuality=m)}})}}),()=>{F.removeTask(l)}},[a,n]),E.useEffect(()=>{const l=setInterval(()=>{var o;const i=at.getPerformanceLevel(),c=F.getFrameStats();console.log("ðŸ”§ Performance Metrics:",{"Performance Level":i,"Animation Efficiency":Math.round(c.efficiency*100)+"%","Scheduler Tasks":F.getTaskCount(),"Spatial Objects":((o=s.current)==null?void 0:o.getStats().totalObjects)||0})},5e3);return()=>clearInterval(l)},[]),E.useEffect(()=>{window.sceneDebug={frustumCuller:t.current,spatialGrid:s.current,getPerformanceLevel:()=>at.getPerformanceLevel(),getSchedulerStats:()=>F.getFrameStats()}},[]),null}const oe=Object.freeze(Object.defineProperty({__proto__:null,SceneManager:Vt},Symbol.toStringTag,{value:"Module"}));export{ee as B,se as P,oe as S};
//# sourceMappingURL=three-components-CwMsZuia.js.map
